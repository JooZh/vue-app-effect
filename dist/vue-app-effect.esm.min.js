/**
* vue-app-effect v1.0.2
* https://github.com/JooZh/vue-app-effect
* Released under the MIT License.
*/
function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var VnodeCache=function(e,t){return{name:"vnode-cache",abstract:!0,props:{},data:function(){return{routerLen:0,route:{},to:{},from:{},tabBar:t,paths:[]}},computed:{},watch:{route:function(e,t){var n=this;this.to=e,this.from=t,-1===this.tabBar.findIndex(function(e){return e===n.$route.fullPath})&&(this.paths.push(e.fullPath),this.paths=[].concat(_toConsumableArray(new Set(this.paths))))}},created:function(){var t=this;this.cache={},this.routerLen=this.$router.options.routes.length,this.route=this.$route,this.to=this.$route,e.$on("reverse",function(){t.reverse()})},destroyed:function(){for(var e in this.cache){var t=this.cache[e];t&&t.componentInstance.$destroy()}},methods:{reverse:function(){var e=this,t=this.paths.pop(),n=this.$router.options.routes,a=this.tabBar.findIndex(function(t){return t===e.$route.fullPath}),r=n.findIndex(function(e){return e.path===t});-1===a&&r>=this.routerLen&&(delete window.$VueAppEffect[t],window.$VueAppEffect.count-=1);var o=-1===a?this.$route.fullPath:"";this.cache[o]&&(this.cache[t].componentInstance.$destroy(),delete this.cache[t])}},render:function(){var e=this;this.route=this.$route;var t=this.$slots.default?this.$slots.default[0]:null;if(t){var n=-1===this.tabBar.findIndex(function(t){return t===e.$route.fullPath})?this.$route.fullPath:"/tab-bar";this.cache[n]?t.componentInstance=this.cache[n].componentInstance:this.cache[n]=t,t.data.keepAlive=!0}return t}}},index={install:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.router,a=t.tabbar,r=t.common,o=void 0===r?"":r;if(n&&a){window.addEventListener("load",function(){n.replace({path:"/"})});var i="\n    .vue-app-effect-out-enter-active,\n    .vue-app-effect-out-leave-active,\n    .vue-app-effect-in-enter-active,\n    .vue-app-effect-in-leave-active {\n      will-change: transform;\n      transition: all 500ms cubic-bezier(0.075, 0.82, 0.165, 1) ;\n      bottom: 50px;\n      top: 0;\n      position: absolute;\n      backface-visibility: hidden;\n      perspective: 1000;\n    }\n    .vue-app-effect-out-enter {\n      opacity: 0;\n      transform: translate3d(-70%, 0, 0);\n    }\n    .vue-app-effect-out-leave-active {\n      opacity: 0 ;\n      transform: translate3d(70%, 0, 0);\n    }\n    .vue-app-effect-in-enter {\n      opacity: 0;\n      transform: translate3d(70%, 0, 0);\n    }\n    .vue-app-effect-in-leave-active {\n      opacity: 0;\n      transform: translate3d(-70%, 0, 0);\n    }",c=document.head||document.getElementsByTagName("head")[0],p=document.createElement("style");p.type="text/css",p.styleSheet?p.styleSheet.cssText=i:p.appendChild(document.createTextNode(i)),c.appendChild(p),window.$VueAppEffect={count:0,paths:[]},o&&(window.$VueAppEffect[o]=9999999);var s=!1,u=Date.now();document.addEventListener("touchend",function(){u=Date.now()}),["push","go","replace","forward","back"].forEach(function(e){var t=n[e].bind(n);n[e]=function(){s=!0;for(var e=arguments.length,n=Array(e),a=0;a<e;a++)n[a]=arguments[a];t.apply(null,n)}});var f=new e;n.beforeEach(function(e,t,n){if(/\/http/.test(e.path))window.location.href=e.path;else{var r=Number(window.$VueAppEffect[e.path]),o=Number(window.$VueAppEffect[t.path]);o=o||0;var i=a.findIndex(function(t){return t===e.path});a.findIndex(function(e){return e===t.path});if(-1===i)if(r>0)r>o?(f.$emit("forward",{type:"forward",isTab:!1,transitionName:"vue-app-effect-in"}),window.$VueAppEffect.paths.push(e.path)):!s&&Date.now()-u<377?f.$emit("reverse",{type:"",isTab:!1,transitionName:"vue-app-effect-out"}):f.$emit("reverse",{type:"reverse",isTab:!1,transitionName:"vue-app-effect-out"});else{var c=++window.$VueAppEffect.count;window.$VueAppEffect.count=c,window.$VueAppEffect[e.path]=c,f.$emit("forward",{type:"forward",isTab:!1,transitionName:"vue-app-effect-in"}),window.$VueAppEffect.paths.push(e.path)}else window.$VueAppEffect.paths.pop(),!s&&Date.now()-u<377?f.$emit("reverse",{type:"",isTab:!0,transitionName:"vue-app-effect-out"}):f.$emit("reverse",{type:"reverse",isTab:!0,transitionName:"vue-app-effect-out"}),window.$VueAppEffect.paths.push(e.path);n()}}),n.afterEach(function(){s=!1}),e.component("vnode-cache",VnodeCache(f,a)),e.direction=e.prototype.$direction={on:function(e,t){f.$on(e,t)}}}else console.error("vue-app-effect need options: router, tabbar")}};export default index;