/**
* vue-app-effect v1.0.2
* https://github.com/JooZh/vue-app-effect
* Released under the MIT License.
*/
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.VueAppEffect=t()}(this,function(){"use strict";var h=function(t,e){return{name:"vnode-cache",abstract:!0,props:{},data:function(){return{routerLen:0,route:{},to:{},from:{},tabBar:e,paths:[]}},computed:{},watch:{route:function(e,t){var n=this;this.to=e,this.from=t,-1===this.tabBar.findIndex(function(e){return e===n.$route.fullPath})&&(this.paths.push(e.fullPath),this.paths=[].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(new Set(this.paths))))}},created:function(){var e=this;this.cache={},this.routerLen=this.$router.options.routes.length,this.route=this.$route,this.to=this.$route,t.$on("reverse",function(){e.reverse()})},destroyed:function(){for(var e in this.cache){var t=this.cache[e];t&&t.componentInstance.$destroy()}},methods:{reverse:function(){var t=this,n=this.paths.pop(),e=this.$router.options.routes,a=this.tabBar.findIndex(function(e){return e===t.$route.fullPath}),r=e.findIndex(function(e){return e.path===n});-1===a&&r>=this.routerLen&&(delete window.$VueAppEffect[n],window.$VueAppEffect.count-=1);var o=-1===a?this.$route.fullPath:"";this.cache[o]&&(this.cache[n].componentInstance.$destroy(),delete this.cache[n])}},render:function(){var t=this;this.route=this.$route;var e=this.$slots.default?this.$slots.default[0]:null;if(e){var n=-1===this.tabBar.findIndex(function(e){return e===t.$route.fullPath})?this.$route.fullPath:"/tab-bar";this.cache[n]?e.componentInstance=this.cache[n].componentInstance:this.cache[n]=e,e.data.keepAlive=!0}return e}}};return{install:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=t.router,c=t.tabbar,a=t.common,r=void 0===a?"":a;if(n&&c){window.addEventListener("load",function(){n.replace({path:"/"})});var o="\n    .vue-app-effect-out-enter-active,\n    .vue-app-effect-out-leave-active,\n    .vue-app-effect-in-enter-active,\n    .vue-app-effect-in-leave-active {\n      will-change: transform;\n      transition: all 500ms cubic-bezier(0.075, 0.82, 0.165, 1) ;\n      bottom: 50px;\n      top: 0;\n      position: absolute;\n      backface-visibility: hidden;\n      perspective: 1000;\n    }\n    .vue-app-effect-out-enter {\n      opacity: 0;\n      transform: translate3d(-70%, 0, 0);\n    }\n    .vue-app-effect-out-leave-active {\n      opacity: 0 ;\n      transform: translate3d(70%, 0, 0);\n    }\n    .vue-app-effect-in-enter {\n      opacity: 0;\n      transform: translate3d(70%, 0, 0);\n    }\n    .vue-app-effect-in-leave-active {\n      opacity: 0;\n      transform: translate3d(-70%, 0, 0);\n    }",i=document.head||document.getElementsByTagName("head")[0],p=document.createElement("style");p.type="text/css",p.styleSheet?p.styleSheet.cssText=o:p.appendChild(document.createTextNode(o)),i.appendChild(p),window.$VueAppEffect={count:0,paths:[]},r&&(window.$VueAppEffect[r]=9999999);var f=!1,u=Date.now();document.addEventListener("touchend",function(){u=Date.now()}),["push","go","replace","forward","back"].forEach(function(e){var a=n[e].bind(n);n[e]=function(){f=!0;for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];a.apply(null,t)}});var s=new e;n.beforeEach(function(t,n,e){if(/\/http/.test(t.path))window.location.href=t.path;else{var a=Number(window.$VueAppEffect[t.path]),r=Number(window.$VueAppEffect[n.path]);r=r||0;var o=c.findIndex(function(e){return e===t.path});c.findIndex(function(e){return e===n.path});if(-1===o)if(0<a)r<a?(s.$emit("forward",{type:"forward",isTab:!1,transitionName:"vue-app-effect-in"}),window.$VueAppEffect.paths.push(t.path)):!f&&Date.now()-u<377?s.$emit("reverse",{type:"",isTab:!1,transitionName:"vue-app-effect-out"}):s.$emit("reverse",{type:"reverse",isTab:!1,transitionName:"vue-app-effect-out"});else{var i=++window.$VueAppEffect.count;window.$VueAppEffect.count=i,window.$VueAppEffect[t.path]=i,s.$emit("forward",{type:"forward",isTab:!1,transitionName:"vue-app-effect-in"}),window.$VueAppEffect.paths.push(t.path)}else window.$VueAppEffect.paths.pop(),!f&&Date.now()-u<377?s.$emit("reverse",{type:"",isTab:!0,transitionName:"vue-app-effect-out"}):s.$emit("reverse",{type:"reverse",isTab:!0,transitionName:"vue-app-effect-out"}),window.$VueAppEffect.paths.push(t.path);e()}}),n.afterEach(function(){f=!1}),e.component("vnode-cache",h(s,c)),e.direction=e.prototype.$direction={on:function(e,t){s.$on(e,t)}}}else console.error("vue-app-effect need options: router, tabbar")}}});